#summary "bitperfect" explained.

= What does "bitperfect" mean, and what do I have to do for bitperfect playback? =

An important indicator for the quality of a soundcard's SPDIF port is the capability of so called "bitperfect playback" - this term coins the ability to directly send sound data to the SPDIF port without having any loss or degradation. If I'd play some wave file while recording the output of the SPDIF port with another soundcard, and if I'd then synchronize and compare both files bit by bit and there wouldn't be any differences, then both soundcards are bitperfect. There are, however, easier ways to test this capability, which will be subject to another article.

Most consumer grade soundcards aren't bitperfect by design: some sound hardware may be limited to only one sample rate to the effect that sound processing is mandatory (sample rate conversion in this case), in other soundcards' drivers there are annoying "features" which can't be fully disabled (e.g. karaoke, fake 3D sound). The latter applies to the C-Media based soundcards: while the hardware is fully capable of bitperfect playback at a multitude of sample rates, all versions of the official driver process the sound. Some versions even cripple the sample size of the sound data from regular 16 bit down to 14 bit which results in a hefty loss of dynamic range (roughly estimated from 96dB/16 bit to 84dB/14 bit).

In the professional grade market, customers expect their soundcards to be bitperfect for obvious reasons, and the drivers are specifically developed for this. These soundcards often come laden with other features which are pretty much useless in a regular home theater/HiFi environment (e.g. multitrack recording). Moreover, they're manufactured in much smaller volume than consumer grade soundcards, hence their pricetag is usually tenfold or even more of what a regular consumer soundcard costs.

So in essence, in the past there have been only two options for the audiophile user: either accept the deterioration of sound quality induced by the driver's processing, or bite the bullet and buy an expensive professional grade soundcard. Not anymore: after reading the specs of a C-Media chip, I decided to write my own driver from scratch which completely avoids processing. It is compatible to C-Media based soundcards which are widely available for a mere 20 US$/â‚¬. The result is a slim and sleek driver which runs on all major Windows operating systems. It supports bitperfect playback for 16 bit sound streams at sample rates of 44.1kHz, 48kHz, 88.2kHz and 96kHz - this covers effectively almost all music on CDs and subsequent formats as well as audio from DVDs on sale today.

On the software side, there are some more obstacles: in order to play multiple sounds simultaneously, a so called "kmixer" which is part of the sound subsystem of Windows mixes them together and adjusts the volume of the resulting stream. Contrary to popular belief, the kmixer of Windows 2000 and XP doesn't modify the sound and is thus bitperfect if these four conditions are met:
  * The PCM/wave volume slider of the mixer (sndvol32.exe) must be at its maximum. Some start-up applications modify the volume slider (e.g. hardware monitoring tools from Asus).
  * The player must be compiled for the same architecture that the OS was compiled for - e.g. 32 bit player on 32 bit OS, 64 bit player on 64 bit OS. This is the case for the vast majority of installations because the 64 bit version of Windows XP isn't very commonly used.
  * Applications other than the player mustn't play sounds, otherwise the two output streams will be potentially sample rate converted and mixed by the kmixer.
  * Applications which use the soundcard for recording must do this at the same sample rate as the playback stream - the hardware uses only one clock generator and hence this limitation arises.
Most parts of the sound subsystem of Windows XP/2000 including the kmixer run in the privileged kernel mode, and this poses a security threat because most drivers are badly written with regard to security. For Vista, the sound subsystem has been completely rewritten - most parts, including the kmixer, run as a service in user mode. Unfortunately, the kmixer of Vista is not bitperfect anymore.

For some users, it may be necessary to bypass the kernel mixer for bitperfect playback. This can be done in either of these two ways:
  * Kernel streaming - this interface has been implemented to 2000/XP/Vista in response to Steinberg's ASIO. Applications which use this interface instead of DirectX/MME bypass the kernel mixer. In Vista, this interface has been marked "deprecated", and it doesn't work with WaveRT versions of the drive, but with non-WaveRT versions of the driver. There are output plugins for all the major players, namely WinAMP and foobar2000.
  * WASAPI - a new interface which appeared first in Vista. Its "exclusive mode" grants bitperfect access to a soundcard for an application. It works with both WaveRT and non-WaveRT version, and there is currently only one usable player that I'm aware of: XM-Play.